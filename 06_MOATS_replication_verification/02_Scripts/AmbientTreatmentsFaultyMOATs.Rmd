---
title: "Ambient Treatments & Faulty MOATs"
output: html_notebook
---



## Author: OA Lab, NWFSC
## Title: Broken MOATs and "Creating" the Ambient Treatment
## Date: August 2020



```{r 0.0 Libraries , echo=FALSE, results=FALSE}
#*********************************
##Libraries
#********************************* 
library(shiny)
library(tidyverse)
library(stringr)
library(readxl)
library(readr)
library(tidyr)
library(data.table)
library(lubridate)
library(violinmplot)
library(vioplot)
library(yarrr)
library(datapasta)
library(reprex)
library(miniUI)
library(gridExtra)
library(wql)
```



# Table of Contents
## Outline Current 2020.06.01

# 1. Setting the Working Directory
# 2. Calling & Reading in " dml "
# 3. Reformatting variables/vectors (Factors)
# 4. Creating dateTime objects
# 5. Creating Treatment Variables
# 6. Creating Night & Day Variables 
# 7. Salinity (4 New Vectors)
# 8. Creating Corrected Salinity Value 
# 9. DO
# 10. Filtering Water Chemistry Dataframe


# 1. Setting the Working Directory
1.0
Look for all files inside the Water Chemistry folder of the "06. MOATs replication verification" folder
```{r 1.0 Setting Working Directory, ECHO= FALSE, message=FALSE, warning=FALSE}
#*********************************
## 1.) Set working directory
#*********************************
knitr::opts_chunk$set(echo = TRUE)

knitr::opts_knit$set(root.dir =
                       "/Users/katherinerovinski/GIT/NWFSC.MUK_KRL_SMR2019/06. MOATS replication verification/01a. WaterChemistry Data")
```

#### 1.1 Initial Working Directoy

#### 1.1 Initial Working Directoy

Inside the working directory (folder) is 1 CSV files generated after combining 13CSV logs representing 24second observations. These CSV files were created using the moats graph app

#### 1.1.2 Link to Generating App

[Link to moats.Graph.app](http://github.com/pmcelhany/moatsGraphs.git)
Moving average window (nObs) set to 4. 

#### 1.1.3 Protocol with app

Every 17th observations was selected, the observations were 24second apart. 

#### 1.1.4 App data for 13 MOATS

1 CSVs per moats: M01, M02, M03, M04, M05, M06, M07, M08, M09, M10, M11, M12, M13. Files are also available on the OA Google drive. [OA Drive for MOATS data](https://drive.google.com/open?id=13a2hk1a9I9gRIgf2Xyl1dSYDf5vnyYvs)

### 1.2 Subsampling

For speed and ease of computations the dataframe was extermely subsampled. 
Instead of the standard "n17" used in the aquarium temperature investigation, this document subsampled at "n333".

#### 1.2.1 Subsampling explained by observations

All observations (per the 13 MOATS logs)
[1] 1137880   7 (6 seconds)
Number of observations after subsampling every 17th response/observation
[1] 66934     7 (24 seconds)
Number of observations after the super-subsampling, every 333rd observation
[1] 3417      7 (~30minutes) ***this won't detail the ramp


#### 1.2.2 Subsampling Determination

To examine the Day to Night ramp (D2Nramp) researcher used n17 subsampling group


# 2.0) Calling and Reading in dml

```{r 2.0 Calling and Reading in dml, ECHO= FALSE, message=FALSE, warning=FALSE, }
#*********************************
## 2. Calling & Reading in " dml " 
#*********************************

# Super Speedy subsampled data
dml <- read.csv(file = "M01thruM13moatslog_n17.csv", stringsAsFactors = FALSE)
dim(dml)

```








This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

